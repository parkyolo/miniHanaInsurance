<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="/src/css/signupPage/accidentReport.css">

    <script src="/src/script/signupPage/accidentReport.js"></script>
</head>

<body onload="step2load()">
    <div id="wrap">
        <header data-include-path="/src/html/layout/header.html"></header>
        <div class="container">
            <div id="mcontents">

                <h1>STEP2 사고사항입력</h1>
                <h6>운전하신 고객님의 정보를 알려주세요</h6>
            
            
                <h6>사고유형을 알려주세요</h6>
                <div class="type-of-accident" id="type-of-accident">
                    <input type="radio" name="accident-type">차대차
                    <input type="radio" name="accident-type">차량단독
                    <input type="radio" name="accident-type">차대인
                    <input type="radio" name="accident-type">기타
                    <!--안보였다가 기타 선택하면 나타나도록-->
                    <input type="text" name="accident-type" placeholder="사고유형을 입력해주세요">
                </div>
                <h6>사고관련 추가정보가 있으시면 등록해주세요.</h6>
                <table border="1">
                    <tbody>
                        <tr>
                            <td>경찰서 신고여부</td>
                            <td>
                                <input type="radio" name="callPolice" default>신고
                                <input type="radio" name="callPolice">미신고
                            </td>
                            <td>경찰서명</td>
                            <td>
                                <input type="text">
                            </td>
                        </tr>
                        <tr>
                            <td>사고내용</td>
                            <td colspan="3">
                                <input type="text" placeholder="사고내용을 기입해주세요">
                            </td>
                        </tr>
                    </tbody>
                </table>
                <h6>사고장소를 알려주세요</h6>
                <table border="1" width="600" height="400">
                    <tr>
                        <td rowspan="2">사고장소</td>
                        <td>
                            <input type="button" value="지도에서 찾기" onclick="document.location.href='map.html'">
                        </td>
                    </tr>
                    <tr>
                        <td>
            
                            <div class="address-from-map">
                                <input type="text" id="mapAddr"></input>
                            </div>
                        </td>
            
                    </tr>
                </table>
            
            
            
            
                <button type="button" id="next-btn-real" onclick="document.location.href='step3.html'" value="다음">다음</button>
            
            
            

                <style>
                    .li {
                        width: 50px;
                        height: 20px;
                        padding: 10px;
                    }
                </style>

                <script>
                    function getImageFiles(e) {
                        const uploadFiles = [];
                        const files = e.currentTarget.files;
                        const imagePreview = document.querySelector('.image-preview');
                        const docFrag = new DocumentFragment();

                        if ([...files].length >= 2) {
                            alert('이미지는 최대 6개 까지 업로드가 가능합니다.');
                            return;
                        }

                        // 파일 타입 검사
                        [...files].forEach(file => {
                            if (!file.type.match("image/.*")) {
                                alert('이미지 파일만 업로드가 가능합니다.');
                                return
                            }

                            // 파일 갯수 검사
                            if ([...files].length < 2) {
                                uploadFiles.push(file);
                                const reader = new FileReader();
                                reader.onload = (e) => {
                                    const preview = createElement(e, file);
                                    imagePreview.appendChild(preview);
                                };
                                reader.readAsDataURL(file);
                            }
                        });
                    }

                    function createElement(e, file) {
                        const li = document.createElement('li');
                        const img = document.createElement('img');
                        img.setAttribute('src', e.target.result);
                        img.setAttribute('data-file', file.name);
                        li.appendChild(img);

                        return li;
                    }

                    const realUpload = document.querySelector('.real-upload');
                    const upload = document.querySelector('.upload');

                    upload.addEventListener('click', () => realUpload.click());

                    realUpload.addEventListener('change', getImageFiles);
                </script>

            </div>
            <footer data-include-path="/src/html/layout/footer.html"></footer>
        </div>
    </div>
    <script>
        window.addEventListener('load', function () {
            var allElements = document.getElementsByTagName('*');
            Array.prototype.forEach.call(allElements, function (el) {
                var includePath = el.dataset.includePath;
                if (includePath) {
                    var xhttp = new XMLHttpRequest();
                    xhttp.onreadystatechange = function () {
                        if (this.readyState == 4 && this.status == 200) {
                            el.outerHTML = this.responseText;
                        }
                    };
                    xhttp.open('GET', includePath, true);
                    xhttp.send();
                }
            });
        });
    </script>
</body>

</html>